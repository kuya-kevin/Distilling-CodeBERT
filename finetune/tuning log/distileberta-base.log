/home/swwwt/.conda/envs/CodeXGLUE/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
epoch 0 loss 8.5927:  26%|███████████████████████████████████████████▏                                                                                                                         | 102/390 [01:01<34:56,  7.28s/it]epoch 0 loss 7.0929:  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 281/390 [01:52<00:31,  3.51it/s]epoch 0 loss 7.0872:  72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 282/390 [01:52<00:30,  3.55it/s]epoch 0 loss 6.648: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [03:34<00:00,  1.82it/s]
04/26/2022 16:21:20 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:21:20 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:21:20 - INFO - __main__ -     Batch size = 64
04/26/2022 16:21:23 - INFO - __main__ -     eval_ppl = 188.89978
04/26/2022 16:21:23 - INFO - __main__ -     global_step = 391
04/26/2022 16:21:23 - INFO - __main__ -     train_loss = 6.648
04/26/2022 16:21:23 - INFO - __main__ -     ********************
04/26/2022 16:21:28 - INFO - __main__ -     Best ppl:188.89978
04/26/2022 16:21:28 - INFO - __main__ -     ********************
/home/swwwt/CodeXGLUE/Code-Text/code-to-text/code/model.py:165: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  prevK = bestScoresId // numWords
Total: 1000
04/26/2022 16:23:02 - INFO - __main__ -     bleu-4 = 8.37
04/26/2022 16:23:02 - INFO - __main__ -     ********************
04/26/2022 16:23:02 - INFO - __main__ -     Best bleu:8.37
04/26/2022 16:23:02 - INFO - __main__ -     ********************
epoch 1 loss 4.8824: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:50<00:00,  3.51it/s]
04/26/2022 16:24:58 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:24:58 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:24:58 - INFO - __main__ -     Batch size = 64
04/26/2022 16:25:01 - INFO - __main__ -     eval_ppl = 120.07069
04/26/2022 16:25:01 - INFO - __main__ -     global_step = 781
04/26/2022 16:25:01 - INFO - __main__ -     train_loss = 4.8824
04/26/2022 16:25:01 - INFO - __main__ -     ********************
04/26/2022 16:25:06 - INFO - __main__ -     Best ppl:120.07069
04/26/2022 16:25:06 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:27:10 - INFO - __main__ -     bleu-4 = 8.12
04/26/2022 16:27:10 - INFO - __main__ -     ********************
epoch 2 loss 4.3676: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:50<00:00,  3.51it/s]
04/26/2022 16:29:01 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:29:01 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:29:01 - INFO - __main__ -     Batch size = 64
04/26/2022 16:29:04 - INFO - __main__ -     eval_ppl = 99.13591
04/26/2022 16:29:04 - INFO - __main__ -     global_step = 1171
04/26/2022 16:29:04 - INFO - __main__ -     train_loss = 4.3676
04/26/2022 16:29:04 - INFO - __main__ -     ********************
04/26/2022 16:29:09 - INFO - __main__ -     Best ppl:99.13591
04/26/2022 16:29:09 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:30:39 - INFO - __main__ -     bleu-4 = 8.5
04/26/2022 16:30:39 - INFO - __main__ -     ********************
04/26/2022 16:30:39 - INFO - __main__ -     Best bleu:8.5
04/26/2022 16:30:39 - INFO - __main__ -     ********************
epoch 3 loss 4.0535: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [02:10<00:00,  2.99it/s]
04/26/2022 16:32:54 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:32:54 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:32:54 - INFO - __main__ -     Batch size = 64
04/26/2022 16:32:56 - INFO - __main__ -     eval_ppl = 88.41975
04/26/2022 16:32:56 - INFO - __main__ -     global_step = 1561
04/26/2022 16:32:56 - INFO - __main__ -     train_loss = 4.0535
04/26/2022 16:32:56 - INFO - __main__ -     ********************
04/26/2022 16:33:01 - INFO - __main__ -     Best ppl:88.41975
04/26/2022 16:33:01 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:34:27 - INFO - __main__ -     bleu-4 = 8.15
04/26/2022 16:34:27 - INFO - __main__ -     ********************
epoch 4 loss 3.8208: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:51<00:00,  3.49it/s]
04/26/2022 16:36:18 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:36:18 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:36:18 - INFO - __main__ -     Batch size = 64
04/26/2022 16:36:21 - INFO - __main__ -     eval_ppl = 81.94014
04/26/2022 16:36:21 - INFO - __main__ -     global_step = 1951
04/26/2022 16:36:21 - INFO - __main__ -     train_loss = 3.8208
04/26/2022 16:36:21 - INFO - __main__ -     ********************
04/26/2022 16:36:26 - INFO - __main__ -     Best ppl:81.94014
04/26/2022 16:36:26 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:38:03 - INFO - __main__ -     bleu-4 = 7.99
04/26/2022 16:38:03 - INFO - __main__ -     ********************
epoch 5 loss 3.6389: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:51<00:00,  3.50it/s]
04/26/2022 16:39:55 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:39:55 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:39:55 - INFO - __main__ -     Batch size = 64
04/26/2022 16:39:57 - INFO - __main__ -     eval_ppl = 77.84423
04/26/2022 16:39:57 - INFO - __main__ -     global_step = 2341
04/26/2022 16:39:57 - INFO - __main__ -     train_loss = 3.6389
04/26/2022 16:39:57 - INFO - __main__ -     ********************
04/26/2022 16:40:02 - INFO - __main__ -     Best ppl:77.84423
04/26/2022 16:40:02 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:41:29 - INFO - __main__ -     bleu-4 = 8.2
04/26/2022 16:41:29 - INFO - __main__ -     ********************
epoch 6 loss 3.4848: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:51<00:00,  3.51it/s]
04/26/2022 16:43:20 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:43:20 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:43:20 - INFO - __main__ -     Batch size = 64
04/26/2022 16:43:23 - INFO - __main__ -     eval_ppl = 73.67914
04/26/2022 16:43:23 - INFO - __main__ -     global_step = 2731
04/26/2022 16:43:23 - INFO - __main__ -     train_loss = 3.4848
04/26/2022 16:43:23 - INFO - __main__ -     ********************
04/26/2022 16:43:28 - INFO - __main__ -     Best ppl:73.67914
04/26/2022 16:43:28 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:44:58 - INFO - __main__ -     bleu-4 = 8.81
04/26/2022 16:44:58 - INFO - __main__ -     ********************
04/26/2022 16:44:58 - INFO - __main__ -     Best bleu:8.81
04/26/2022 16:44:58 - INFO - __main__ -     ********************
epoch 7 loss 3.3639: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:51<00:00,  3.51it/s]
04/26/2022 16:46:54 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:46:54 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:46:54 - INFO - __main__ -     Batch size = 64
04/26/2022 16:46:56 - INFO - __main__ -     eval_ppl = 71.03952
04/26/2022 16:46:56 - INFO - __main__ -     global_step = 3121
04/26/2022 16:46:56 - INFO - __main__ -     train_loss = 3.3639
04/26/2022 16:46:56 - INFO - __main__ -     ********************
04/26/2022 16:47:01 - INFO - __main__ -     Best ppl:71.03952
04/26/2022 16:47:01 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:48:35 - INFO - __main__ -     bleu-4 = 9.9
04/26/2022 16:48:35 - INFO - __main__ -     ********************
04/26/2022 16:48:35 - INFO - __main__ -     Best bleu:9.9
04/26/2022 16:48:35 - INFO - __main__ -     ********************
epoch 8 loss 3.2702: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:50<00:00,  3.52it/s]
04/26/2022 16:50:31 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:50:31 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:50:31 - INFO - __main__ -     Batch size = 64
04/26/2022 16:50:33 - INFO - __main__ -     eval_ppl = 70.53992
04/26/2022 16:50:33 - INFO - __main__ -     global_step = 3511
04/26/2022 16:50:33 - INFO - __main__ -     train_loss = 3.2702
04/26/2022 16:50:33 - INFO - __main__ -     ********************
04/26/2022 16:50:38 - INFO - __main__ -     Best ppl:70.53992
04/26/2022 16:50:38 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:52:12 - INFO - __main__ -     bleu-4 = 10.64
04/26/2022 16:52:12 - INFO - __main__ -     ********************
04/26/2022 16:52:12 - INFO - __main__ -     Best bleu:10.64
04/26/2022 16:52:12 - INFO - __main__ -     ********************
epoch 9 loss 3.2015: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [01:51<00:00,  3.51it/s]
04/26/2022 16:54:08 - INFO - __main__ -
***** Running evaluation *****
04/26/2022 16:54:08 - INFO - __main__ -     Num examples = 1400
04/26/2022 16:54:08 - INFO - __main__ -     Batch size = 64
04/26/2022 16:54:10 - INFO - __main__ -     eval_ppl = 70.10256
04/26/2022 16:54:10 - INFO - __main__ -     global_step = 3901
04/26/2022 16:54:10 - INFO - __main__ -     train_loss = 3.2015
04/26/2022 16:54:10 - INFO - __main__ -     ********************
04/26/2022 16:54:15 - INFO - __main__ -     Best ppl:70.10256
04/26/2022 16:54:15 - INFO - __main__ -     ********************
Total: 1000
04/26/2022 16:55:47 - INFO - __main__ -     bleu-4 = 10.76
04/26/2022 16:55:47 - INFO - __main__ -     ********************
04/26/2022 16:55:47 - INFO - __main__ -     Best bleu:10.76
04/26/2022 16:55:47 - INFO - __main__ -     ********************
(